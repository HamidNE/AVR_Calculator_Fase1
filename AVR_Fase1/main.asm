/*-----------------
	Init Stack	
-----------------*/

LDI R16,LOW(RAMEND)
OUT SPL,R16
LDI R16,HIGH(RAMEND)
OUT SPH,R16

/*---------------------
	Init DDRA, DDRC	
---------------------*/

LDI R16,0XFF

OUT DDRA,R16
OUT DDRC,R16


/***************************
	Show Student Numbers
***************************/

// 1. Emad Kavoosi => 941402125

LDI R20,255
LOP1:

	LDI R16,2
	CALL CONVERT_FOR_7_SEGMENT
	OUT PORTA,R16
	LDI R21,0B11101111
	OUT PORTC,R21
	CALL DELAY
	LDI R21,0B11111111
	OUT PORTC,R21

	LDI R16,1
	CALL CONVERT_FOR_7_SEGMENT
	OUT PORTA,R16
	LDI R21,0B11011111
	OUT PORTC,R21
	CALL DELAY
	LDI R21,0B11111111
	OUT PORTC,R21

	LDI R16,2
	CALL CONVERT_FOR_7_SEGMENT
	OUT PORTA,R16
	LDI R21,0B10111111
	OUT PORTC,R21
	CALL DELAY
	LDI R21,0B11111111
	OUT PORTC,R21

	LDI R16,5
	CALL CONVERT_FOR_7_SEGMENT
	OUT PORTA,R16
	LDI R21,0B01111111
	OUT PORTC,R21
	CALL DELAY
	LDI R21,0B11111111
	OUT PORTC,R21

	DEC R20

BRNE LOP1


// 2. Hamid Nasr Esfahani => 941402191

LDI R20,255
LOP2:

	LDI R16,2
	CALL CONVERT_FOR_7_SEGMENT
	OUT PORTA,R16
	LDI R21,0B11101111
	OUT PORTC,R21
	CALL DELAY
	LDI R21,0B11111111
	OUT PORTC,R21

	LDI R16,1
	CALL CONVERT_FOR_7_SEGMENT
	OUT PORTA,R16
	LDI R21,0B11011111
	OUT PORTC,R21
	CALL DELAY
	LDI R21,0B11111111
	OUT PORTC,R21

	LDI R16,9
	CALL CONVERT_FOR_7_SEGMENT
	OUT PORTA,R16
	LDI R21,0B10111111
	OUT PORTC,R21
	CALL DELAY
	LDI R21,0B11111111
	OUT PORTC,R21

	LDI R16,1
	CALL CONVERT_FOR_7_SEGMENT
	OUT PORTA,R16
	LDI R21,0B01111111
	OUT PORTC,R21
	CALL DELAY
	LDI R21,0B11111111
	OUT PORTC,R21

	DEC R20

BRNE LOP2


// 3. Hossein Hashemi => 941402134

LDI R20,255
LOP3:

	LDI R16,2
	CALL CONVERT_FOR_7_SEGMENT
	OUT PORTA,R16
	LDI R21,0B11101111
	OUT PORTC,R21
	CALL DELAY
	LDI R21,0B11111111
	OUT PORTC,R21

	LDI R16,1
	CALL CONVERT_FOR_7_SEGMENT
	OUT PORTA,R16
	LDI R21,0B11011111
	OUT PORTC,R21
	CALL DELAY
	LDI R21,0B11111111
	OUT PORTC,R21

	LDI R16,3
	CALL CONVERT_FOR_7_SEGMENT
	OUT PORTA,R16
	LDI R21,0B10111111
	OUT PORTC,R21
	CALL DELAY
	LDI R21,0B11111111
	OUT PORTC,R21

	LDI R16,4
	CALL CONVERT_FOR_7_SEGMENT
	OUT PORTA,R16
	LDI R21,0B01111111
	OUT PORTC,R21
	CALL DELAY
	LDI R21,0B11111111
	OUT PORTC,R21

	DEC R20

BRNE LOP3


// 4. Fariba Mohammadi => 931419149

LDI R20,255
LOP4:

	LDI R16,9
	CALL CONVERT_FOR_7_SEGMENT
	OUT PORTA,R16
	LDI R21,0B11101111
	OUT PORTC,R21
	CALL DELAY
	LDI R21,0B11111111
	OUT PORTC,R21


	LDI R16,1
	CALL CONVERT_FOR_7_SEGMENT
	OUT PORTA,R16
	LDI R21,0B11011111
	OUT PORTC,R21
	CALL DELAY
	LDI R21,0B11111111
	OUT PORTC,R21


	LDI R16,4
	CALL CONVERT_FOR_7_SEGMENT
	OUT PORTA,R16
	LDI R21,0B10111111
	OUT PORTC,R21
	CALL DELAY
	LDI R21,0B11111111
	OUT PORTC,R21

	LDI R16,9
	CALL CONVERT_FOR_7_SEGMENT
	OUT PORTA,R16
	LDI R21,0B01111111
	OUT PORTC,R21
	CALL DELAY
	LDI R21,0B11111111
	OUT PORTC,R21

	DEC R20

BRNE LOP4


/***********************
	Show Light Dance
***********************/

L0:

	// Step1

	LDI R20,10
	LOOP1:

		LDI R16,0B00000111
		OUT PORTA,R16
		LDI R21,0B01111111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		DEC R20

	BRNE LOOP1



	// Step2

	LDI R20,10
	LOOP2:

		LDI R16,0B11
		OUT PORTA,R16
		LDI R21,0B01111111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		LDI R16,0B1
		OUT PORTA,R16
		LDI R21,0B10111111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		DEC R20

	BRNE LOOP2



	// Step3

	LDI R20,10
	LOOP3:

		LDI R16,0B1
		OUT PORTA,R16
		LDI R21,0B01111111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		LDI R16,0B1
		OUT PORTA,R16
		LDI R21,0B10111111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		LDI R16,0B1
		OUT PORTA,R16
		LDI R21,0B11011111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		DEC R20

	BRNE LOOP3



	// Step4

	LDI R20,10
	LOOP4:

		LDI R16,0B1
		OUT PORTA,R16
		LDI R21,0B10111111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		LDI R16,0B1
		OUT PORTA,R16
		LDI R21,0B11011111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		LDI R16,0B1
		OUT PORTA,R16
		LDI R21,0B11101111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		DEC R20

	BRNE LOOP4



	// Step5

	LDI R20,10
	LOOP5:

		LDI R16,0B1
		OUT PORTA,R16
		LDI R21,0B11011111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		LDI R16,0B1
		OUT PORTA,R16
		LDI R21,0B11101111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		LDI R16,0B100001
		OUT PORTA,R16
		LDI R21,0B11101111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		DEC R20

	BRNE LOOP5



	// Step6

	LDI R20,10
	LOOP6:

		LDI R16,0B1
		OUT PORTA,R16
		LDI R21,0B11101111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		LDI R16,0B110001
		OUT PORTA,R16
		LDI R21,0B11101111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		DEC R20

	BRNE LOOP6


	// Step7

	LDI R20,10
	LOOP7:

		LDI R16,0B111000
		OUT PORTA,R16
		LDI R21,0B11101111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		DEC R20

	BRNE LOOP7


	// Step8

	LDI R20,10
	LOOP8:

		LDI R16,0B11000
		OUT PORTA,R16
		LDI R21,0B11101111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		LDI R16,0B1000
		OUT PORTA,R16
		LDI R21,0B11011111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		DEC R20

	BRNE LOOP8


	// Step9

	LDI R20,10
	LOOP9:

		LDI R16,0B1000
		OUT PORTA,R16
		LDI R21,0B11101111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		LDI R16,0B1000
		OUT PORTA,R16
		LDI R21,0B11011111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		LDI R16,0B1000
		OUT PORTA,R16
		LDI R21,0B10111111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		DEC R20

	BRNE LOOP9



	// Step10

	LDI R20,10
	LOOP10:

		LDI R16,0B1000
		OUT PORTA,R16
		LDI R21,0B11011111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		LDI R16,0B1000
		OUT PORTA,R16
		LDI R21,0B10111111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		LDI R16,0B1000
		OUT PORTA,R16
		LDI R21,0B01111111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		DEC R20

	BRNE LOOP10



	// Step11

	LDI R20,10
	LOOP11:

		LDI R16,0B1000
		OUT PORTA,R16
		LDI R21,0B01111111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		LDI R16,0B1100
		OUT PORTA,R16
		LDI R21,0B01111111
		OUT PORTC,R21
		CALL DELAY
		LDI R21,0B11111111
		OUT PORTC,R21

		DEC R20

	BRNE LOOP11

JMP L0

/*****************
	Functions
*****************/

/*----------------------
	Convert 7Segment
----------------------*/

CONVERT_FOR_7_SEGMENT:

	CPI R16,00
	BRNE CF7S01
	LDI R16,0B00111111
	JMP FOR_RET

	CF7S01:
		CPI R16,01
		BRNE CF7S02
		LDI R16,0B00000110
		JMP FOR_RET

	CF7S02:
		CPI R16,02
		BRNE CF7S03
		LDI R16,0B1011011
		JMP FOR_RET

	CF7S03:
		CPI R16,03
		BRNE CF7S04
		LDI R16,0B1001111
		JMP FOR_RET

	CF7S04:
		CPI R16,04
		BRNE CF7S05
		LDI R16,0B1100110
		JMP FOR_RET

	CF7S05:
		CPI R16,05
		BRNE CF7S06
		LDI R16,0B1101101
		JMP FOR_RET

	CF7S06:
		CPI R16,06
		BRNE CF7S07
		LDI R16,0B1111101
		JMP FOR_RET

	CF7S07:
		CPI R16,07
		BRNE CF7S08
		LDI R16,0B0000111
		JMP FOR_RET

	CF7S08:
		CPI R16,8
		BRNE CF7S09
		LDI R16,0B1111111
		JMP FOR_RET

	CF7S09:
		CPI R16,9
		BRNE CF7SEND
		LDI R16,0B1101111
		JMP FOR_RET

	CF7SEND:

	FOR_RET:
		RET


/*-----------
	Delay
-----------*/

DELAY:
	PUSH R17
	PUSH R18
	PUSH R19
	LDI R19,100
	D0:
		LDI R18,5
		D1:	
			LDI R17,2
			D2:
				NOP
				DEC R17
			BRNE D2
			DEC R18
		BRNE D1
		DEC R19
	BRNE D0
	POP R19
	POP R18
	POP R17

	RET